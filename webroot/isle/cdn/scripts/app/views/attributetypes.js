define(["jquery","../Util","../NodeManager"],function(e,t,n){e(function(){var r=new n,i=!1;e("html").attr("data-role")>=ISLE_CONTRIBUTOR&&(i=!0);var s={fieldNames:{id:"hidId",unit:"txtUnit",abbr:"txtAbbr",parent:"txtParent"},limit:500,tree:!0,order:[{col:"unit"}],itemName:"Attribute Type",modelName:"AttributeType",buildTable:function(n){function c(s,h){if(s!=""){a="",f=0;while(f<h)a+="&nbsp;&nbsp;",f++;u=n.items[s],l="",u.abbr!==null&&(l=" ("+t.htmlEncode(t.abbreviate(u.abbr,50))+")"),r="",i="",e("html").attr("data-role")>=ISLE_CONTRIBUTOR&&(r='<td><span role="button" tabindex="0" id="'+u.id+'" title="Edit"><i class="icon-edit"></i></span></td>',i="<td></td>"),u.id<5?e("#nodeTable").append('<tr class="unclickable">'+i+'<td class="bold">'+a+t.htmlEncode(t.abbreviate(u.unit))+l+"</td></tr>"):e("#nodeTable").append("<tr>"+r+"<td>"+a+t.htmlEncode(t.abbreviate(u.unit))+l+"</td></tr>")}e.isArray(o[s])&&e.each(o[s],function(e,t){c(t,h+1)});return}var r="",i="";e("#nodeTable").html("");var s=[],o=n.parents,u="",a="",f=0,l="";c("",-1)},modalInit:function(n){var r='<option value="">-- Select a parent</option>';e.each(n.items,function(e,n){r+='<option value="'+n.id+'">'+t.htmlEncode(t.abbreviate(n.unit))+"</option>"}),e('#modalDialog select[name="'+this.fieldNames.parent+'"]').html(r)},fillForm:function(n,r,i){var s=e(i).attr("id"),o=n.items[s],u=o.unit,a=o.abbr,f=o.parent,l=n.items[f],c="",h="";typeof l!="undefined"&&(l.abbr!==null&&(h=" ("+t.htmlEncode(t.abbreviate(l.abbr,50))+")"),c=l.unit+h),e('#modalDialog input[name="'+this.fieldNames.id+'"]').val(s),e('#modalDialog input[name="'+this.fieldNames.unit+'"]').val(u),e('#modalDialog input[name="'+this.fieldNames.abbr+'"]').val(a);var p='<option value="">-- Select a parent</option>',d=[];t.getDescendants(s,d,n.parents),e.each(n.items,function(n,r){r["id"]!=s&&e.inArray(r.id,d)<0&&(h="",r.abbr!==null&&(h=" ("+t.htmlEncode(t.abbreviate(r.abbr,50))+")"),p+='<option value="'+r.id+'">'+t.htmlEncode(t.abbreviate(r.unit))+h+"</option>")}),e('#modalDialog select[name="'+this.fieldNames.parent+'"]').html(p).val(f),e("#modalDialog .ui-combobox input").val(c)},duplicate:{field:"unit",errorMsg:"That unit already exists"},rowsClickable:i};r.initialize(s),e("#"+s.fieldNames.parent).combobox()})})